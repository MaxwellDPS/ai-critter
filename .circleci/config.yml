# Use the latest 2.1 version of CircleCI pipeline process engine.
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1

jobs:
  build:
    docker: 
      - image: python:3.9-bullseye
    steps:
      - run:
          name: Install Apt Dependencies
          command: |
          apt-get install -y git libgl1-mesa-glx netcdf-bin libnetcdf-dev \
libhdf5-dev libatlas-base-dev libhdf5-serial-dev
      - run:
          name: Install Pip Dependencies
          command: |
          pip install --upgrade pip && \
          pip install --upgrade cython
       - run:
          name: Adding Base Requirements.txt
          command: |
          ADD requirements.txt requirements.txt && \
          RUN pip install -r requirements.txt
       - run: 
          name: Install NCS Dependencies
          command: |
          ADD requirements_ncs.txt requirements_ncs.txt && \
RUN pip install -r requirements_ncs.txt

# Invoke jobs via workflows
# See: https://circleci.com/docs/2.0/configuration-reference/#workflows
workflows:
  ai-critter:
    jobs:
      - ai-critter-camera
      - ai-critter-web
